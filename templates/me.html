{% extends "base.html" %}
{% block screen %}
            <div class="top" data-role="header" data-position="fixed">
                <a href="/" data-role="button" data-icon="arrow-l" data-direction="reverse" data-transition="slide" data-theme="a" data-prefetch>返回</a>
                <h1>我的名片</h1>
            </div>
            
            <div data-role="content">
                <div class="meta">
                    <img class="avatar" src="{{ user.avatar }}">
                    <p class="name">{% if user.get_full_name %}
                        {{ user.get_full_name }}
                    {% else %}您的姓名{% endif %}</p>
                    <p><a href="index.html" data-role="button" data-icon="gear" data-iconpos="left" data-mini="true" data-inline="true">编辑</a></p>
                </div>
                <ul class="social" data-role="listview" data-split-icon="delete" data-split-theme="d">
                    <li data-role="list-divider" role="heading">社交</li>
                    {% for s in socials %}
                        <li class="social">
                            <a href="{{ s.url }}"><i class="{{ s.icon }}"></i>{{ s.uname }}</a>
                            <a href="#delete" data-rel="popup" data-position-to="window" data-transition="pop">解除绑定</a>
                        </li>
                    {% endfor %}
                    <li class="social">
                        <a href="#popup_addsocial" data-rel="popup"><i class="icon-plus"></i>添加社交网络帐号…</a>
                    </li>
                </ul>
                <div data-role="popup" id="popup_addsocial">
                	<ul data-role="listview" data-inset="true" data-theme="c">
                    	<li><a href="/conns/renren_connect" data-transition="pop" data-ajax="false">人人网</a></li>
                    	<li><a href="/conns/weibo_connect" data-transition="pop" data-ajax="false">新浪微博</a></li>
                    	<li><a href="/conns/tqq_connect" data-transition="pop" data-ajax="false">腾讯微博</a></li>
                    	<li><a href="/conns/jiepang_connect" data-transition="pop" data-ajax="false">街旁</a></li>
                    	<li><a href="/conns/github_connect" data-transition="pop" data-ajax="false">GitHub</a></li>
                	</ul>
                </div>
                <div data-role="popup" id="popup_addcontact">
                	<ul data-role="listview" data-inset="true" data-theme="c">
                    	<li><a href="#popup_addcontact_phone" data-rel="popup">电话号码</a></li>
                    	<li><a href="#popup_addcontact_email" data-rel="popup">Email</a></li>
                    	<li><a href="#popup_addcontact_address" data-rel="popup">地址</a></li>
                	</ul>
                </div>
                <div data-role="popup" class="popup_addcontact_form" id="popup_addcontact_phone" data-theme="a" data-position-to="window">
                    <a href="#" data-rel="back" data-role="button" data-theme="a" data-icon="delete" data-iconpos="notext" class="ui-btn-right">Close</a>
        			<form action="/me/" method="post">{% csrf_token %}
                        <h3>添加电话号码</h3>
                        <input type="hidden" name="type" value="Phone">
                        <input type="hidden" name="action" value="add">
                        <script>
                        $(document).ready(function() {
                            $("#phone_select_key").change(function() {
                                if (!$(this).val()) {
                                    $('#phone_custom_key').show();
                                } else {
                                    $('#phone_custom_key').hide();
                                }
                            });
                        });
                        </script>
                        <select id="phone_select_key" name="key">
                            <option value="手机">手机</option>
                            <option value="家庭">家庭</option>
                            <option value="工作">工作</option>
                            <option value="">自定义</option>
                        </select>
                        <input id="phone_custom_key" type="text" name="key_custom" value="" placeholder="名称" style="display: none;">
                        <input type="tel" name="value" placeholder="号码" data-theme="a">
                        <button type="submit" data-theme="b">添加</button>
        			</form>
        		</div>
        		<script>
        		$(document).ready(function() {
        		    $(".delete_item").click(function() {
        		        if (confirm("确定删除这条联系方式么？")) {
        		            $("#delete_info_id").val($(this).attr("data-info_id"));
        		            $("#delete_form").submit();
        		        } else {
        		            return false;
        		        }
        		    });
        		});
        		</script>
        		<form method="post" action="/me/" hidden="true" id="delete_form">
        		    <input type="hidden" name="action" value="delete">
        		    <input type="hidden" id="delete_info_id" name="info_id" value="">
        		</form>
                <ul class="contact" data-role="listview" data-split-icon="delete" data-split-theme="d">
                    <li data-role="list-divider" role="heading">联系</li>
                    {% for item in contact_info %}
                    <li>
                        <a><p class="key">{{ item.key }}</p>
                        <p class="value">{{ item.value }}</p></a>
                        <a href="#" class="delete_item" data-info_id="{{ item.info_id }}">删除</a>
                    </li>
                    {% endfor %}
                    <li>
                        <a href="#popup_addcontact" data-rel="popup">添加联系方式…</a>
                    </li>
                    <li class="map">
                    大！地！图！百度！
                    </li>
                </ul>
            </div>
{% endblock %}
